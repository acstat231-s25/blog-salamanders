---
title: "Word Frequencies"
author: Jenna Holmes
---


```{r}
#| label: setup
#| include: false

# Improve digit display and NA display for kable tables
options(scipen = 1, knitr.kable.NA = "")

# Load necessary packages
library(tidyverse)
library(knitr)
library(kableExtra)
library(ggplot2)
library(plotly)
library(ggwordcloud)
library(xfun)
library(RColorBrewer)
library(wordcloud)
library(ggpubr)
library(scales)

# color palette for some consistency
 new_jpalette <- colorRampPalette(colors = c("#6b34eb"
                                            , "#F3AB4D"
                                            , "#eb6309"
                                            , "#d92b1e"
                                            , "sienna"
                                            , "midnightblue" ))(6)
 
 new_jpalette2 <- colorRampPalette(colors = c("darkorchid1"
                                            , "#F3AB4D"
                                            , "#d92b1e"
                                            , "midnightblue" ))(6)
```

### Word Clouds for Word Frequencies in Lyrics by Genre

::: {.panel-tabset}

### Rock

```{r}
#| label: Tab 1 - Rock
#| include: true
#| message: false
#| warning: false
#| fig-width: 8
#| fig-height: 6

Rock_word_freqs = read_csv("data/Rock_lyrics_word_freqs.csv")

# 1970s Rock decade
Rock1 <- ggplot(Rock_word_freqs |> 
                  filter(decade == "1970") |>
                   slice_max(n, n = 44), 
                aes(label = word, size = n, color = n)) +  
  geom_text_wordcloud(
    family = "sans",             
    random.order = TRUE,    
    # Percentage of words rotated
    rotate_ratio = 0.15,          
    # Use `color` for word color, depending on frequency
    show.legend = FALSE,
    rm_outside = TRUE,
    #word sizes proportionate to cloud area
    area_corr = TRUE
  ) +
  # Size scale for cloud
  scale_size_area(max_size = 15) +
  scale_color_gradientn(colors = new_jpalette) + 
  ggtitle("Rock Word Cloud - 1970s") +  
  theme_minimal() +  
  theme(legend.position = "none",  
        plot.background = element_rect(fill = "white", color = "white")) 

# 1980s Rock decade
Rock2 <- ggplot(Rock_word_freqs |> 
                  filter(decade == "1980") |>
                   slice_max(n, n = 44), 
                aes(label = word, size = n, color = n)) +  
  geom_text_wordcloud(
    family = "sans",             
    random.order = TRUE,  
    # Percentage of words rotated
    rotate_ratio = 0.15,           
    # Use `color` for word color, depending on frequency
    show.legend = FALSE,
    rm_outside = TRUE,
    #word sizes proportionate to cloud area
    area_corr = TRUE
  ) +
  # Size scale for cloud
  scale_size_area(max_size = 18) +
  scale_color_gradientn(colors = new_jpalette) + 
  ggtitle("Rock Word Cloud - 1980s") +  
  theme_minimal() +  
  theme(legend.position = "none",  
        plot.background = element_rect(fill = "white", color = "white"))

# 1990s Rock decade
Rock3 <- ggplot(Rock_word_freqs |> 
                  filter(decade == "1990") |>
                   slice_max(n, n = 30), 
                aes(label = word, size = n, color = n)) +  
  geom_text_wordcloud(
    family = "sans",               
    random.order = TRUE,
    # Percentage of words rotated
    rotate_ratio = 0.15, 
    # Use `color` for word color, depending on frequency
    show.legend = FALSE,
    rm_outside = TRUE,
    #word sizes proportionate to cloud area
    area_corr = TRUE
  ) +
  # Size scale for cloud
  scale_size_area(max_size = 15) +
  scale_color_gradientn(colors = new_jpalette) +  
  ggtitle("Rock Word Cloud - 1990s") +  
  theme_minimal() + 
  theme(legend.position = "none", 
        plot.background = element_rect(fill = "white", color = "white"))

# 2000s Rock decade
Rock4 <- ggplot(Rock_word_freqs |> 
                  filter(decade == "2000") |>
                   slice_max(n, n = 44), 
                aes(label = word, size = n, color = n)) +  
  geom_text_wordcloud(
    family = "sans",           
    random.order = TRUE,     
    # Percentage of words rotated
    rotate_ratio = 0.15,           
    # Use `color` for word color, depending on frequency
    show.legend = FALSE,
    rm_outside = TRUE,
    #word sizes proportionate to cloud area
    area_corr = TRUE
  ) +
  # Size scale for cloud
  scale_size_area(max_size = 20) +
  scale_color_gradientn(colors = new_jpalette) + 
  ggtitle("Rock Word Cloud - 2000s") +
  theme_minimal() + 
  theme(legend.position = "none", 
        plot.background = element_rect(fill = "white", color = "white"))

#arrange four clouds for one tab
ggarrange(Rock1, Rock2, Rock3, Rock4, ncol = 2, nrow = 2)
```

### Dance

```{r}
#| label: Tab 2 - Dance
#| include: true
#| message: false
#| warning: false
#| fig-width: 8
#| fig-height: 6

Dance_word_freqs = read_csv("data/Dance_lyrics_word_freqs.csv")

# 1960s Dance decade
Dance1 <- ggplot(Dance_word_freqs |> 
                   filter(decade == "1960") |>
                   slice_max(n, n = 45), 
                aes(label = word, size = n, color = n)) +  
  geom_text_wordcloud(
    family = "sans",             
    random.order = TRUE,
    # Percentage of words rotated
    rotate_ratio = 0.15,          
    # Use `color` for word color, depending on frequency
    show.legend = FALSE,
    rm_outside = TRUE,
    #word sizes proportionate to cloud area
    area_corr = TRUE
  ) +
  # Size scale for cloud
  scale_size_area(max_size = 20) +
  scale_color_gradientn(colors = new_jpalette) + 
  ggtitle("Dance Word Cloud - 1960s") +  
  theme_minimal() +  
  theme(legend.position = "none",  
        plot.background = element_rect(fill = "white", color = "white")) 

# 1970s Dance decade
Dance2 <- ggplot(Dance_word_freqs |> 
                   filter(decade == "1970") |>
                   slice_max(n, n = 45),
                aes(label = word, size = n, color = n)) +  
  geom_text_wordcloud(
    family = "sans",             
    random.order = TRUE,
    # Percentage of words rotated
    rotate_ratio = 0.15,           
    # Use `color` for word color, depending on frequency
    show.legend = FALSE ,
    rm_outside = TRUE,
    #word sizes proportionate to cloud area
    area_corr = TRUE
  ) +
  # Size scale for cloud
  scale_size_area(max_size = 20) +
  scale_color_gradientn(colors = new_jpalette) + 
  ggtitle("Dance Word Cloud - 1970s") +  
  theme_minimal() +  
  theme(legend.position = "none",  
        plot.background = element_rect(fill = "white", color = "white"))

# 1980s Dance decade
Dance3 <- ggplot(Dance_word_freqs |> 
                   filter(decade == "1980") |>
                   slice_max(n, n = 45), 
                aes(label = word, size = n, color = n)) +  
  geom_text_wordcloud(
    family = "sans",               
    random.order = TRUE,
    # Percentage of words rotated
    rotate_ratio = 0.15, 
    # Use `color` for word color, depending on frequency
    show.legend = FALSE,
    rm_outside = TRUE,
    #word sizes proportionate to cloud area
    area_corr = TRUE
  ) +
  # Size scale for cloud
  scale_size_area(max_size = 17) +
  scale_color_gradientn(colors = new_jpalette) +  
  ggtitle("Dance Word Cloud - 1980s") +  
  theme_minimal() + 
  theme(legend.position = "none", 
        plot.background = element_rect(fill = "white", color = "white"))

#arrange three clouds for one tab
ggarrange(Dance1, Dance2, Dance3, ncol = 2, nrow = 2)
```

### Slow

```{r}
#| label: Tab 3 - Slow
#| include: true
#| message: false
#| warning: false
#| fig-width: 8
#| fig-height: 6

Slow_word_freqs = read_csv("data/Slow_lyrics_word_freqs.csv")

# Slow word cloud
Slow_word_freqs |>
    with(wordcloud(words = word,
                   freq = n,
                  max.words = 50,
random.order = TRUE,
# Specify the range of the size of the words
scale = c(4, 0.6),
# Specify proportion of words with 90 degree rotation
rot.per = 0.15,
# Color words from least to most frequent
colors = new_jpalette2,
family = "sans"))
```

:::

The above three tabs portray word frequencies for Rock, Dance, and Slow music genres. Our dataset had numerous genres, however Rock, Dance, and Slow were the three genres with most songs, thus they were chosen to be represented in the word clouds. The Rock genre is divided into four decades, namely the 1970's through the 2000's. Likewise, the Dance genre is divided into three decades, specifically the 1960's through the 1980's. One cumulative word cloud is displayed for the Slow genre, representing various decades in a cohesive manner.

Referencing the Rock tab, the 70's Rock word cloud conveys "time," "future," and "lord" as three of the most common words in this decade for the genre, representing people's faith and desires for future change. Numerous anti-war protests, women's liberation acts, civil rights movements, etc. occurred during this decade, alluding to the aforementioned terms having higher frequencies in song lyrics. The terms "love" and "baby" are emphasized in the 80's Rock word cloud, supporting the fact that this decade produced countless unforgettable love songs, including "Should I Stay or Should I Go" by The Clash, "With or Without You" by U2, "Love Shack" by The B-52's. The 90's word cloud highlights words such as "perdedor," "kill," "denial," and "loser." Nirvana became incredibly popular during the early 90's, which contributed significantly to the rebellious spirit of the decade, as seen in these most common words from the cloud. The 2000's word cloud displays "life" and "lust" as having the highest word frequencies in Rock songs from this decade, which is sensible given that Indie rock was born in the early 2000's, bringing with it themes of independence and authenticity. The Rock genre overall conveys strong ideas of love as well as a representation of the societal/musical changes and movements that occurred during each decade.

Similarly, the Dance tab portrays word frequencies within the genre via three word clouds, one each from the 1960's, 1970's, and 1980's. The 60's word cloud shows "baby," "love," and "chain" as the words with higher frequencies in the Dance genre during this decade, which is supported by the fact that love was one of the more popular themes in 1960's music. According to the 70's cloud, "funk" and "light" had high word frequencies is the Dance music genre, given that funk and rhythm were popular in the 1970's. The 80's cloud demonstrates "boogie," "beat," "bang," and "party" as words of higher frequencies is this decade of Dance music, which aligns with the fact that the boogie sound was defined in the early 80's. Love, attachment, and funk are words of high frequency in the cumulative Dance genre (all three decades combined), and each decade had words of higher frequencies that were associated with popular themes during each of those years, such as the boogie and funk.

Lastly, the Slow tab conveys word frequencies from the cumulative Slow music genre and displays "chain," "beat," "boogie," and "baby" as the terms with higher frequencies, supported by the alignment of these terms with the emotional themes of Slow music. "Chain" is a term often used in slower songs to represent emotional bondage and attachment. The term "beat" can be used to convey slower rhythms, and "boogie" is used in a nostalgic sense. "Baby" is often used in lyrics of love, which commonly occur in slower songs.

Each of the three genres differ in terms of the themes conveyed by their most frequent words, however love is a commonly represented notion. Furthermore, the isolation of various decades within the Rock and Dance genres highlights the relationship between the societal and musical movements that occurred and the words of highest frequency in song lyrics written during those years. Despite any commonly embodied themes across the three genres, each genre still exhibited unique concepts. The Rock genre as a whole conveys key concepts of love and expression. The Dance genre cumulatively represents energy and rhythm, and lastly the Slow genre conveys emotion and steady paces.