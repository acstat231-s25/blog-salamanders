---
title: "The 1960s were a Great Decade for Music"
author: 
- "Claire Albus"
abstract: ""
---

```{r}
#| label: setup
#| include: false

# Improve digit display and NA display for kable tables
options(scipen = 1, knitr.kable.NA = "")

# Load necessary packages
library(tidyverse)
library(knitr)
library(kableExtra)
library(plotly)
library(ggwordcloud)
library(xfun)
library(RColorBrewer)
library(wordcloud)
library(ggpubr)
library(scales)
library(ggtext)
library(gt)

# set up color palette for the next few plots
 new_palette <- colorRampPalette(colors = c("#6b34eb"
                                            , "#F3AB4D"
                                            , "#eb6309"
                                            , "#d92b1e"
                                            , "#540340"
                                            , "#C6C2B8" ))(6)
 # Rolling Stone

#he famous, sometimes infamous, <i>Rolling Stone</i> magazine #published its first issue on November 9th, 1967. 



```

## Through the Decades 

Let's take a look at how the decades shape up compared to one another. 
```{r, message=FALSE}
 #| label: decade favorability
 #| include: true
 #| warning: false
 #| show_col_types: false
 
 
 # necessary data wrangling since r reads the decades as integers instead 
 # of levels in the csv 
 songs_chart = read_csv("data/songs_chart.csv")
 # add back the s to the decades
 songs_chart$decade = paste0(songs_chart$decade, "s")
 # decade integers to factors in a logical order
 songs_chart$decade = 
    factor(songs_chart$decade
           , levels = c('50s', '60s', '70s', '80s', '90s', '2000s')) 
 # sort rank blocks into order that best demonstrates top 100 distribution
 songs_chart$block =
   factor(songs_chart$block
          , levels = c('500s', '400s', '300s', '200s', 'Top 100'))
 
 # build plot
decadent <- songs_chart |> 
   # Create segmented histogram
   ggplot(aes(x = decade, fill = block)) +
     geom_bar(position = "stack", color = "black") +
     scale_fill_manual(values = new_palette, name = "Rank") +
     labs(
      #title = "Decades Represented: By Rank"
       x = "Decade of Release"
      , y = "Number of Songs"
      , caption = "Figure 1: The above segmented bar chart shows the distribution across decades <br> of 
      Rolling Stone Magazine's Top 500 Songs of All Time from 2013. The colors <br>
      of the segments show where on the list to find songs from a particular decade."
      ) +
     theme_linedraw() +
     theme(plot.caption = ggtext::element_markdown(hjust = 0, vjust = -1
                                                   , size = rel(0.92)
                                                   , color = "#3b3d3c"
                                                   , box.color = "#3b3d3c"
                                                   , linewidth = 0.5
                                                   , linetype = 1
                                                   , padding = unit(5, "pt")
                                                   , margin = margin(t = 20))
           , axis.title.x = element_text(vjust = -0.3, size = rel(1.5))
           , axis.text.x = element_text(size = rel(1.25))
           , axis.title.y = element_text(size = rel(1.5))
           , axis.text.y = element_text(size = rel(1.25))) 
 

```

```{r}
#| label: fig-decade
decadent
```
 

 
 
@fig-decade above shows the distribution of the decades represented in <i>Rolling Stone</i> Magazine's Top 500 Songs of All Time. In this, we can see that the 1960s are the clear leader in terms of representation on the list. In fact, roughly 35% of the songs on the list are from the 60s. The 70s follow at around 25%, and the 50s, 80s, and 90s each represent around 10-13% of the list. For more information on this breakdown, see @tbl-dec. There is a clear trend downward from the 60s to the 2000s, with the 2000s being the least represented decade. 
 
Taking a closer look at where the songs fall in the ranking categories, i.e., Top 100, 200s, and so on, we can see that the 1960s have the most songs in the top 100 among all decades. However, this likely follows from 60s songs' representation in the list. Interestingly, even though the 70s have many more songs on the list than the 50s, the 50s have slightly more songs in the Top 100. 
 
 
### Rolling Stone's Top Three Artists

While all the artists on this list are well-deserving of their flowers, there are three artists who stand out among the rest. Combined, these three artists make up nearly 10% of the songs on the list. These artists are, of course, <b>The Beatles</b>, <b>The Rolling Stones</b>, and <b>Bob Dylan</b>

::: {.panel-tabset}
 
### Top Artists

```{r}
#| label: decades of top artists' songs
#| include: true
#| message: false
#| warning: false


 # necessary data wrangling since r reads the decades as integers instead 
 # of levels in the csv 
 top_artists = read_csv("data/top_artists.csv")
 # add the s back to the decades
 top_artists$decade = paste0(top_artists$decade, "s")
 # decade integers to factors in a logical order
 top_artists$decade = 
    factor(top_artists$decade
           , levels = c('2000s', '90s', '80s', '70s', '60s', '50s'))  
 
 tops <- top_artists |> 
   # Create segmented histogram
   ggplot(aes(x = artist, fill = decade)) +
     geom_bar(color = "black") +
     scale_fill_manual(values = new_palette, name = "Decade") +
     labs(
      x = "Artist"
      , y = "Number of Songs"
      , tag = " "
      , caption = "Figure 2: The segmented bar chart above shows the number of songs each of the <br> 
      top three most represented artists has on the list. The segments show the decade of <br>
      release of these artists' songs."
      ) +
     theme_linedraw() +
     theme(plot.caption = ggtext::element_markdown(hjust = 0, vjust = -1
                                                   , size = rel(0.92)
                                                   , color = "#3b3d3c"
                                                   , box.color = "#3b3d3c"
                                                   , linewidth = 0.5
                                                   , linetype = 1
                                                   , padding = unit(5, "pt")
                                                   , margin = margin(t = 20))
           , axis.title.x = element_text(vjust = -0.3, size = rel(1.5))
           , axis.text.x = element_text(size = rel(1.25))
           , axis.title.y = element_text(size = rel(1.5))
           , axis.text.y = element_text(size = rel(1.25))) 
 
```

```{r}
#| label: fig-tops

tops
```

### Top Sentiments

```{r}
#| label: sentiment of top artists' songs
#| include: true
#| message: false
#| warning: false

songs_chart = read_csv("data/songs_chart.csv")
sentiment_by_artist = read_csv("data/sentiment_by_artists.csv")

# palette for plot
new_palette2 = colorRampPalette(colors = c("#540340"
                                            , "#eb6309"
                                            , "#d92b1e"))(3)
sentiment_by_artist |>
   ggplot(aes(x = artist, y = mean, fill = artist)) +
   scale_fill_manual(values = new_palette2) +
   geom_col(stat = "identity") +
   labs(
     title = "Sentiments of The Top 3"
     , y = "Average Sentiment"
     , x = "Artist"
   ) +
   geom_text(aes(label = mean), vjust = -0.125) +
   theme_linedraw() +
   geom_hline(yintercept = 0, linetype = "dashed") +
   guides(fill = FALSE) +
   theme(axis.title.x = element_text(vjust = -0.3)
        # , axis.title.y = element_text(vjust = -0.3)
         )
```

:::

For music lovers and <i>Rolling Stone</i> Magazine subscription-holders, it will come as little surprise that the top 3 artists represented in Rolling Stone's Top 500 are, in order, The Beatles, The Rolling Stones, and Bob Dylan. The Top Artists chart above demonstrates the margin by which The Beatles' songs outnumber the other two. The Beatles have a stunning 23 songs on the list---24 if you include John Lennon's <i>Imagine</i>. The top ranking song from the supergroup is <i>Hey Jude</i> which ranks at 8 on the list. The Rolling Stones follow The Beatles with 14 songs, their first on the list, <i>Satisfaction</i>, at slot 2. Finally, Bob Dylan's first feature, the number 1 slot on the list, is <i>Like a Rolling Stone</i>. 

### Supplemental Tables

```{r}
#| label: create tables 
props <- songs_chart |>
  count(decade) |>
  mutate(Percent = (n/500) * 100) |>
  rename(Count = n, Decade = decade) 

to <- top_artists |>
  count(artist) |>
  add_row(artist = "Total", n = 49) |>
  mutate(Percent = (n/500) * 100) |>
  rename(Artist = artist, Count = n) 

son <- songs_chart |>
  select(Rank = number, Artist = artist, Title = title, Year = year
         , Decade = decade) |>
  slice(1:10) 

```


```{r}
#| label: tbl-dec
#| tbl-cap: Decades

pro <- gt(props) |>
  tab_header(
    title = "Songs on List by Decade"
  ) |>
  tab_spanner(
    label = "Metrics"
    , columns = c(Count, Percent)
  )
  pro
  
```
```{r}
#| label: tbl-artists
#| tbl-cap: Artists

gt(to) |>
  tab_header(
    title = "Songs on List by Artist"
  ) |>
  tab_spanner(
    label = "Metrics"
    , columns = c(Count, Percent)
  )
```

```{r}
#| label: tbl-ten
#| tbl-cap: Top Ten

gt(son) |>
  tab_header(
    title = "The Top Ten"
  ) |>
  tab_spanner(
    label = "Song Identifier"
    , columns = c(Artist, Title)
  ) |>
  tab_spanner(
    label = "Release"
    , columns = c(Year, Decade)
  ) |>
  tab_options(quarto.disable_processing = TRUE)
  

```

